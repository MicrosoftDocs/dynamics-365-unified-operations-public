---
# required metadata

title: DOM
description: DOM
author: josaw1
manager: AnnBe
ms.date: 10/31/2018
ms.topic: index-page
ms.prod: 
ms.service: dynamics-365-retail
ms.technology: 

# optional metadata

# ms.search.form: 
# ROBOTS: 
audience: Application User
# ms.devlang: 
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
# ms.tgt_pltfrm: 
ms.custom: 
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2018-10-31
ms.dyn365.ops.version: 

---
# Distributed Order Management

## Overview

In the new paradigm of retail, retailers strive to provide personalized customer engagement, omni-channel experiences and friction less interactions to consumers. Retailers expect to compete mainly on customer experience. With so many choices available to consumers, they’ll shop with whoever provides a more favorable experience. Price and product will no longer be the top deciders.

To improve the customer experience, retailers must gain real-time inventory visibility across all their channels. A single, holistic view of all inventory allows companies to optimize order fulfillment, allocation, and distribution.

As such, adaptation & implementation of a Distributed Order Management (DOM) system is no longer a matter of choice for retailers. DOM optimizes order fulfillment across a complex network of systems and processes. It relies on a single, global view of inventory across an entire organization to intelligently manage orders, so they are fulfilled accurately and cost effectively. Distributed order management improves the efficiency of a retailer’s supply chain, allowing them to better meet customer expectations.

In short, Distributed order management (DOM) has surpassed from a top trend to a necessity for retailers. The lifecycle of a sales order in the context of DOM can be better understood with the help of the below image.


![Sales order lifecycle in the context of DOM](./media/flow.png "Sales order lifecycle in the context of DOM")
**Setup**

1.  To use the DOM functionality, enable the ‘Distributed Order Management’ configuration key as available in the path: **System administration > Setup > License configuration > Retail**


2.  Navigate to **Retail > Distributed order management > Setup > DOM parameters > General** tab

      a.  Set “Enable distributed order management” to Yes

      b.  Set “Confirm Bing Maps usage for DOM” to Yes. This parameter can only be set to Yes if the parameter under Retail > Headquarters setup > Parameters > Retail shared parameters > Bing Maps > Enable Bing Maps is also set to Yes and a valid key is provided in the field ‘Bing Maps key’

      c.  Specify a value (days) in the field ‘Retention period in days’. This parameter determines for how long the fulfillment plans that are generated by the DOM runs are retained in the system. Any fulfillment plan that is older than the no. of days defined in this parameter will be deleted by the batch job “DOM fulfillment data deletion job setup”
    

3.  Navigate to **Retail > Distributed order management > Setup > DOM parameters > Solver** tab

      a.  Specify a value (no. of) in the field “Max auto-fulfillment attempts”. This parameter governs how many attempts will the DOM engine make to broker an order line to a location. If the DOM engine is not able to broker the order line to a location in the no. of attempts as defined in this parameter, then the DOM engine will flag the relevant order line as an exception and will skip the line from future execution runs till its status is manually re-set

   	  b.  Specify a value (in miles) in the field ‘Local store region radius’. This parameter helps to configure as to how locations are grouped and considered to be equal in terms of distance. For e.g.: if the value in this parameter is set to 100, then every store / DC within 100-mile radius of the fulfillment address is considered equal in terms of distance.
      
      c.  Specify a value in the field ‘Solver type’. There are two Solver types that are shipped out of the box – ‘Production Solver’ & ‘Simplified Solver’. The ‘Production Solver’ needs a special license key which is already licensed & deployed on production environments. For other environments, this special license key must be manually deployed. The ‘Simplified Solver’ is a mechanism to try out the DOM feature without having to deploy this special license.


 **Note:**

 1.  Organizations should not use the ‘Simplified Solver’ in Production environments

 2.  While the ‘Simplified Solver’ provides the same set of capabilities as the ‘Production Solver’, there are limitations around performance (no. of order / order lines it can handle in a run) & convergence of results (may not be the best result with a batch of orders in specific scenarios)

4.  Navigate to **Retail > Distributed order management > Setup > DOM parameters > Number sequences** tab

	a.  Assign the required number sequences to the different DOM entities. The Number sequences needs to be defined under **Organization administration > Number sequences > Number sequences** before they can be assigned to the entities

5.  The DOM feature supports the definition of different types of DOM rules and these DOM rules can be defined for a group of locations or individual locations and for a certain product category, product or variant. These grouping of locations that needs to be used for the DOM rules can be created as per the below steps:

	a.  Navigate to **Retail > Channel setup > Fulfillment groups**

	b.  Click New and assign a group Name and Description

	c.  Click Save

	d.  Use the buttons ‘Add line’ or ‘Add lines’ to add the different locations to this group

6.  The DOM feature supports the definition of different types of DOM rules and organizations can choose to configure multiple rules of a type based on business needs. These rules can be defined under the following path: **Retail > Distributed order management > Setup > Manage rules**.

    The below is the complete list of DOM rules that are supported in this release of the feature:

	a.  **Minimum inventory rule:** This rule type helps organization to ringfence certain qty of a product for non-order fulfillment purposes. For e.g.: organizations may not want all the inventory that is available in a Store to be considered by DOM for order fulfillment. They may want to reserve some qty to 	service their walk-in customers. This can be achieved by leveraging this rule type. A minimum inventory to be retained can be defined per location or a group of locations for a category of products, individual product or product variant.

	b.  **Fulfillment location priority rule:** This rule type allows organizations to define a hierarchy of locations using ‘Priority’, that the DOM engine should consider when trying to identify fulfillment locations for specific products. Locations with higher priority are considered first before resolving to other 	          	locations. A location with a priority of 1 is of higher priority as compared to a location with priority 2.

	c.  **Partial orders rule:** This rule allows organization to configure if an order or order lines can be fulfilled partially. The below are the details of the behavior of the different parameters on the rule:
  
       i.  Fulfill partial orders: If this is set to Yes, it indicates that DOM should assign fulfillment locations to lines even if only few of the lines in the order can be fulfilled
       
       ii.  Fulfill partial lines: If this is set to Yes, it indicates that DOM can fulfill partial qty of order lines and this is achieved by splitting the order line
       
       iii.  Fulfill from one location: If this is set to Yes, DOM will ensure that few lines of an order can be fulfilled from one location and others from a different location
       
       The below table explains the behavior with a combination of the above parameters:

| **#** | **Fulfill partial order** | **Fulfill Partial lines** | **Fulfill from one location only** | **Description**                                                                                                                                                                                  |
|--------|---------------------------|---------------------------|------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1      | Yes                       | Yes                       | Yes                                | Few lines of the order can be fulfilled, individual lines can be partially fulfilled but all of them must be from the same location in an instance of DOM run                                    |
| 2      | Yes                       | No                        | Yes                                | Few lines of the order can be fulfilled however individual lines cannot be partially fulfilled and the fulfilled lines must be from the same location in an instance of the DOM run              |
| 3      | Yes                       | Yes                       | No                                 | Few lines of the order can be fulfilled, and individual lines can be partial fulfilled, and each individual line can be fulfilled from more than one location in an instance of the DOM run      |
| 4*    | No                        | -                         | No                                 | All order lines must be fulfilled, and the lines cannot be partially fulfilled while each order line can be fulfilled from a different location                                                  |
| 5*    | No                        | -                         | Yes                                | All order lines must be fulfilled, and the lines cannot be partially fulfilled while all the order lines can be delivered from one location only                                                 |
| 6*    | No                        | -                         | No                                 | Same as Point (4) because Fulfill partial lines cannot be Yes when Fulfill partial order is No                                                                                                   |
| 7*    | No                        | -                         | Yes                                | Same as Point (5) because Fulfill partial lines cannot be Yes when fulfill partial order is No                                                                                                   |
| 8      | Yes                       | No                        | No                                 | Few lines of the order can be fulfilled but individual lines cannot be partially fulfilled. The different order lines can be fulfilled from more than one location in an instance of the DOM run |
| 9*    | No                        | -                         | Yes                                | All order lines must be fulfilled and all the order lines have to be fulfilled from one location only                                                                                            |

*If ‘Fulfill partial order’ is set to No, then ‘Fulfill partial lines’ is always considered to be No irrespective of what has been set for it.

   d.  **Offline fulfillment location rule:** This rule allows the organization to specify a location or group of locations as off-line or unavailable to DOM for assigning orders for fulfillment
   
   e.  **Maximum rejects rule:** This rule allows the organization to define a threshold for rejects, and on hitting that threshold, the DOM processor will mark an order or order line for exception and exclude it from further processing.
   
   After order lines are assigned to a location, the location has an option to ‘Reject’ the assigned order line as they may not be able to fulfill it for multiple reasons. Such rejected lines are marked as exception and put back in the pool for processing in the next run. In the next run, DOM will try and assign that line to 	a different location. After assignment, that location can also reject the order line for fulfillment. This cycle of assignment & rejection can happen multiple times and the moment the rejection count hits the threshold as defined by this rule, DOM will mark this order line as an exception of permanent nature and 	will not pick this line for assignment again.
   
   Only if a user resets the status of this order line manually, will DOM consider it again for assignment.
   
   f.  **Maximum distance rule:** This rule allows the organization to define the maximum distance, a location or group of locations can go out to fulfill the order. If there are overlapping maximum distance rules define for a location, then DOM will apply the lower of the defined maximum distance for that location.
   
   g.  **Maximum orders rule:** This rule allows the organization to define the maximum number of orders a location or group of locations can process in a calendar day. If a location is assigned the maximum no. of orders in each day, then DOM will not assign any more orders to that location for that calendar day.
   
   Some of the common attributes that can be defined for all the above rule types are explained below:
   
   a.  Start date / End date: Every rule can date bound using the Start date & End date fields
   
   b.  Disabled: Rules that have a value of No for this field are the only ones that are considered in a DOM run
   
   c.  Hard constraint: A rule can be defined either as a hard constraint or not a hard constraint. Every DOM run goes through two iterations. In the first iteration, every rule is treated as a hard constraint rule irrespective of this setting, in other words, every rule is applied.
   
   In the second iteration, the rules that are not defined as hard constraints are removed and the order / order lines that are not assigned to locations when the full rule set was applied, are attempted to be assigned to locations with a reduced rule count (as the not hard constraints rules are removed).


7.  Fulfillment profiles are used to bring together a collection of rules, legal entities, sales order origins & modes of delivery and every DOM run is for a specific Fulfillment profile. Doing so, enables organization to define & execute a set of rules for a set of legal entities, sales order origins and modes of delivery. So, if different set of rules are to be executed for different set of sales order origins or modes of delivery, they can be configured and executed by defining the fulfillment profiles accordingly

The below are the steps to set-up the Fulfillment profiles:

   a.  Navigate to **Retail > Distributed order management > Setup > Fulfillment profiles**
   
   b.  Click **New**
   
   c.  Specify a value for ‘Profile’ and ‘Description’ fields
   
   d.  In the ‘Auto apply result’ field, choose the relevant value (Yes / No). If this field is set to Yes, the results of the DOM execution for this profile will be automatically applied to the sales order lines. If set to No, the results can only be viewed in the Fulfillment plan and they will not be applied to the sales order lines
   
   e.  If you want the DOM profile to be executed for orders with every sales order origin value including undefined ones, then set the field **‘Process orders with empty sales origin’** to Yes. If you want to execute the profile for few sales order origins only, then you can define those in the Setup section of the 	profiles (explained in one of the below points)
   
   f.  In the **Legal entities** fast tab, click **Add** and select a legal entity. (In this release of the feature, only one legal entity can be selected)
   
   g.  In the **Rules** fast tab, click **Add** and from the drop-down option in the ‘Rule’ field, select the rule that you want to link to the profile
   
   h.  Repeat the above step till all the required rules are associated to the profile
   
   i.  Click **Save**
   
   j.Click **Setup > Modes of delivery**
   
   k. Click **New**
   
   l. From the drop down in the Company field, select the legal entity (The list of companies available in the drop down will be limited to the company added in the Legal entity section of the fulfillment profiles)
   
   m. From the drop down in the Mode of delivery field, select the mode of delivery for which you want to associate this profile. **Note:** The same mode of delivery cannot be associated to multiple active profiles
   
   n. Repeat the above step till all the required mode of delivery are associated to the profile
   
   o. Close the form
   
   p. Click **Setup > Sales order origins**
   
   q. Click **New**
   
   r. From the drop down in the Company field, select the legal entity (The list of companies available in the drop down will be limited to the company added in the Legal entity section of the fulfillment profiles)
   
   s. From the drop down in the sales origin field, select the sales origin for which you want to associate this profile. **Note:** The same Sales origin cannot be associated to multiple active profiles
   
   t. Repeat the above step till all the required Sales origin are associated to the profile
   
   u. Close the form
   
   v. Set the field **“Enable profile’** to Yes. If there are any errors in the setup, the system will give relevant warning message when trying to set this field to Yes.

**DOM Processing**

DOM is expected to be run in batch. To configure the batch job for the DOM runs, please follow the below steps:

   1.  Navigate to **Retail > Distributed order management > Batch processing > DOM processor job setup**
   
   2.  In the Fulfillment profile field, select a profile for which the DOM execution must be run
   
   3.  Select a configured Batch group
   
   4.  Use the Recurrence tab to define the recurrence of the batch job
   
   5.  Click **OK**

At the time of processing, DOM will consider the order and order lines as outlined below:

Order lines that meet the criteria for Sales order origins, modes of delivery and legal entity as defined in the DOM profile and

   a.  are created from retail channels
   
   b.  are never brokered by DOM
   
   c.  have been brokered by DOM before but are marked as exception and are below the maximum threshold attempt
   
   d.  where the mode of delivery is not ‘Pick-up’
   
   e.  are not marked for delivery
   
   f.  are not manually excluded
   
   g.  Orders that are not ‘On hold’

After applying the rules, inventory constraints & optimization, DOM will pick a location that is closest to the customer’s delivery address.

![Sales order criteria](./media/ordercriteria.png "Sales order criteria")


**DOM execution results**

If the Fulfillment profile is set to “Auto apply”, the results of the execution run will be automatically applied to the sales order lines and the fulfillment plan also be viewed separately. However, if the Fulfillment profile is not set to “Auto apply”, then the results of the execution can be seen only from the fulfillment plan view. The below are the steps to see all the generated fulfillment plans:

1.  Navigate to the DOM workspace through the Home page or **through Retail > Distributed order management > Distributed order management**

2.  Click on the **Fulfillment plans** tile

3.  Click on the relevant Order fulfillment plan id to see the fulfillment plan

4.  The order details section of the plan shows the original sales order lines that was part of the execution. Beyond the standard sales order line fields, the order details section also show the three DOM related fields as below:

    a.  **Fulfillment type:** Indicates if the sales order line is fully brokered / Partially brokered / Not brokered at all to a location

    b.  **Split:** Indicates if one sales order line has been split and brokered to different locations

    c.  **No. of fulfillment locations:** Indicates how many fulfillment lines were created for one sales order lines (based on how many locations was that one original sales order line brokered to)

5.  The order fulfillment details section shows the assignment of the original sales order lines to different locations along with their quantities.

**Order line actions & statuses**

1.  On the **General** tab of the sales order & sales order line, there is a field called as ‘Exclude from DOM processing’. Setting this field to Yes, will exclude the order / order line from DOM processing

2.  On the **General** tab of the sales order line, there is a field called as ‘DOM status’. The DOM status field can one of three values as explained below:

    a.  None – The order line has never been brokered

    b.  Complete – The order line is successfully brokered and assigned to a location

    c.  Exception – The order line is brokered but cannot be assigned to a location. There are multiple sub-types for exceptions which can be viewed from the DOM workspace. The sub-types for exception are as follows:
    
       i.  No quantity available – Inventory is not available in the locations to assign the order to
       
       ii.  Maximum rejections – The order line has reached the maximum threshold in terms of locations rejecting the order
       
       iii.  Data modification conflict – The sales order line has been changed since the order was brokered and as such the fulfillment plan cannot be applied to the order
       
       iv.  Order line specific exception – There are multiple reasons for this exception

3.  DOM can be run in an interactive mode during the sales order entry process. While entering the order line, after specifying the product & qty, the user can use the option ‘Suggest fulfillment location’ under the path **Update line > DOM** to get a list of locations based on DOM rules that can fulfill the qty on the order line. The list of locations is sorted by distance and choosing a location sets the relevant site & warehouse on the sales order line

4.  The user has capability to see the DOM run logs for a sales order line using the option ‘View DOM logs’ under the path **Sales order line > DOM.** The DOM logs will show the user all the events and logs generated by the DOM run which will help the users to understand as to why a specific location was assigned to the order line and what rules & constraints were considered as a part of that assignment.

### **DOM fulfillment plan clean-up job**

As DOM runs are being executed, fulfillment plans get created. Over a period, the system will have numerous fulfillment plans. To manage this, a batch job can be configured to delete older fulfillment plans based on the value defined the parameter ‘Retention period in days’. The steps for the same are outlined below:

   1.  Navigate to **Retail > Distributed order management > Batch processing > DOM fulfillment data deletion job setup**
   
   2.  Select a configured Batch group
   
   3.  Use the Recurrence tab to define the recurrence of the batch job
   
   4.  Click **OK**

**Additional information**

The below are some of the things to factor for in the usage of DOM feature:

   1.  For this release of the feature, DOM only looks at orders created from Retail channels. Sales orders are identified as retail sales orders when the field ‘Retail sale’ is set to Yes.
   
   2.  DOM has not been tested with Advanced warehouse management features. As such, due diligence from customers and partners is required to determine if DOM is compatible with the Advanced warehouse management capabilities & processes that are relevant for them.
   
   3.  DOM is only available on the Cloud version of the product. DOM is not supported in an on-prem deployment.


