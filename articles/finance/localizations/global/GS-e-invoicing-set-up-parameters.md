---
title: Configure Electronic invoicing parameters
description: This article explains how to set up the Electronic invoicing parameters.
author: ilikond
ms.date: 01/29/2024
ms.topic: article
ms.prod: 
ms.technology: 
audience: Application User
ms.reviewer: johnmichalak
ms.search.region: 
ms.author: ikondratenko
ms.search.validFrom: 2024-01-29
ms.dyn365.ops.version: 10.0.39
ms.custom: 
ms.assetid: 
ms.search.form: 
---

# Configure Electronic invoicing parameters 

[!include [banner](../../includes/banner.md)]

## Enable Electronic invoicing integration

To enable communication between Electronic invoicing and Finance or Supply Chain Management, you must enable the **Electronic Invoicing integration** feature.

1. Log in to Microsoft Dynamics 365 Finance or Dynamics 365 Supply Chain Management.
2. In the **Feature management** workspace, in the **All** tab, search for the **Electronic invoicing integration** feature. If this feature doesn't appear on the page, select **Check for updates**.
3. Select the feature, and then select **Enable now**.

## Import ER configurations from the repository

The process of submitting electronic documents to the Electronic invoicing service requires that a message be generated in your Microsoft Dynamics 365 Finance or Dynamics 365 Supply Chain Management in a unified structure that corresponds to the structure of the Electronic reporting (ER) invoice model and metadata that is known as *context*. Because the message is generated by ER, its structure is customizable and flexible.

Before you can submit documents to Electronic invoicing and process responses, you must import ER configurations from the repository and define them in parameters.

To set up, adjust, or review electronic documents directly in your Finance or Supply Chain Management environment, complete the following procedures.

1. In the **Globalization Studio** workspace, select the **Electronic reporting** tile.
2. In the **Configuration providers** section, select the **Microsoft** configuration provider, and then select **Repositories**.
3. Select the repository of the **Dataverse** type, and then, on the Action Pane, select **Open**.
4. Import the following ER models:

    - **Customer invoice context model**
    - **Invoice model**
    - **Fiscal documents** (for Brazilian scenarios, if required)
    - **Retail channel data** (for Saudi Arabian Retail-specific scenarios, if required)
    - **Response message model**

5. Verify that the following mapping configurations were automatically imported. If they weren't, import them, and then close the page.
    - **Invoice model mapping**
    - **Fiscal documents mapping** (for Brazilian scenarios, if required)
    - **Advance invoice model mapping** (for Polish scenarios, if required) 
    - **Retail fiscal document mapping** (for Saudi Arabian Retail-specific scenarios, if required)

## Set up Electronic document parameters

1. Go to **Organization administration** \> **Setup** \> **Electronic document parameters**.
2. On the **Electronic document** tab, select **Add** above the **Electronic reporting** grid.
3. Depending on the scenarios that you want to support, enter the following information in the grid, and then save your changes.

    | Table name | Document context | Electronic document model mapping | Features that it's required for |
    |------------|------------------|-----------------------------------|-----------------------|
    | CustInvoiceJour | <p>**Mapping name:** Customer invoice context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Customer Invoice</p><p>**Configuration:** Invoice model mapping</p> | <ul><li>Austrian electronic invoices (AT)</li><li>Belgian electronic invoice (BE)</li><li>Danish electronic invoice (DK)</li><li>Egyptian electronic invoice (EG)</li><li>Estonian electronic invoice (EE)</li><li>Finish electronic invoice (FI)</li><li>French electronic invoice (FR)</li><li>German electronic invoice (DE)</li><li>FatturaPA (IT)</li><li>Dutch electronic invoice (NL)</li><li>Norwegian electronic invoice (NO)</li><li>Polish electronic invoice (PL)</li><li>Spanish electronic invoice (ES)</li><li>PEPPOL electronic invoice</li><li>Saudi Arabian electronic invoice (SA)</li><li>Australian electronic invoice (AU)</li><li>New Zealand electronic invoice (NZ)</li></ul> |
    | ProjInvoiceJour | <p>**Mapping name:** Project invoice context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Project Invoice</p><p>**Configuration:** Invoice model mapping</p> | <ul><li>Austrian electronic invoices (AT)</li><li>Belgian electronic invoice (BE)</li><li>Danish electronic invoice (DK)</li><li>Egyptian electronic invoice (EG)</li><li>Estonian electronic invoice (EE)</li><li>Finish electronic invoice (FI)</li><li>French electronic invoice (FR)</li><li>German electronic invoice (DE)</li><li>FatturaPA (IT)</li><li>Dutch electronic invoice (NL)</li><li>Norwegian electronic invoice (NO)</li><li>Polish electronic invoice (PL)</li><li>Spanish electronic invoice (ES)</li><li>PEPPOL electronic invoice</li><li>Saudi Arabian electronic invoice (SA)</li><li>Australian electronic invoice (AU)</li><li>New Zealand electronic invoice (NZ)</li></ul> |
    | CzCustAdvanceInvoiceTable | <p>**Mapping name:** Advance invoice context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Advance invoice model mapping</p><p>**Configuration:** Advance invoice model mapping</p> | Polish electronic invoice (PL) |
    | RetailTransactionFiscalTransDocumentView | <p>**Mapping name:** Retail fiscal document context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Retail fiscal document</p><p>**Configuration:** Retail fiscal document mapping</p> | Saudi Arabian electronic invoice (SA) |
    | FiscalDocument_BR | <p>**Mapping name:** Fiscal document context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Fiscal documents mapping</p><p>**Configuration:** Fiscal documents mapping</p> | Brazilian NF-e (BR) |
    | Correction letter | <p>**Mapping name:** FD correction letter context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Correction letter mapping</p><p>**Configuration:** Fiscal documents mapping</p> | Brazilian NF-e (BR) |
    | Service Fiscal document | <p>**Mapping name:** Fiscal document context</p><p>**Configuration:** Customer invoice context model</p> | <p>**Mapping name:** Fiscal documents mapping</p><p>**Configuration:** Fiscal documents mapping</p> | Brazilian NFS-e ABRASF Curitiba (BR) |

If you derive a configuration from the configuration that is mentioned in the preceding table, define the new configuration.

To set up the rules to process responses from the Electronic invoicing service, and to update Finance and Supply Chain Management data based on invoices that are processed by the service, set up response types. In most scenarios, this setup is country/region-specific. Therefore, we recommend that you follow the country/region-specific instructions. For more information, see [Availability of Electronic invoicing features by country or region](e-invoicing-country-specific-availability.md).

## Legacy Electronic invoicing functionality inactivation

To inactivate old (legacy) ER functionality for some features and activate additional functionality in Finance and Supply Chain Management for some country/region-specific scenarios, enable the corresponding feature on the **Features** tab of the **Electronic document parameters** page.

When you enable a feature from the list, the legacy functionality will be inactivated for the corresponding country or region and feature name.

## Create a Key Vault reference

1. In the **Electronic invoicing** tab, in the **Key Vault settings** FastTab, select **Key Vault parameters**.
2. On the **Key Vault parameters** page, select **New** to create a Key Vault reference.
3. In the **Name** field, enter the name of the Key Vault reference.
4. In the **Description** field, enter a description.
5. In the **Key Vault URI** field, paste the Key Vault URI from the key vault (`https://<your key vault>.vault.azure.net/`). For more information, see [Create an Azure key vault in the Azure portal](e-invoicing-create-azure-key-vault-azure-portal.md).
6. in the **Certificates** section, select **Add**.
7. In the **Name** field, enter the name of the storage account secret or certificate. This name should match the name of the Key Vault secret that holds the storage shared access signature (SAS) token. For more information, see [Create an Azure storage account in the Azure portal](e-invoicing-create-azure-storage-account-azure-portal.md). 
8. In the **Description** field, enter a description.
9. In the **Type** field, select **Secret** or **Certificate** depending on what is being configured.
    > [!NOTE]
    > In some scenarios, you must use public certificates that have the .cer file name extension. However, Key Vault doesn't support importing and storing certificates of this type as Key Vault certificates. In these scenarios, you should save the .cer file as a Base-64-encoded X.509 (.CER) string. Then, in a Key Vault secret, store the string that appears between the **BEGIN CERTIFICATE** line and the **END CERTIFICATE** line in the file. In the service environment, you should still create a reference to the Key Vault record and set the **Type** field to **Certificate**.

   As an alternative to the approach that's described in the preceding note, use the following PowerShell script to generate a Base-64 string of the .cer certificate file.

    ```powershell
    $FilePath = ''
    $Cer = New-Object -TypeName System.Security.Cryptography.X509Certificates.X509Certificate2($FilePath)
    $BinCert = $Cer.GetRawCertData()
    $Base64Cert = [System.Convert]::ToBase64String($BinCert)
    echo $Base64Cert
    ```

10. If your specific scenarios require a chain of certificates to apply digital signatures or establish a secure (Secure Sockets Layer \[SSL\]) connection to external web services, create a chain of certificates where the certificates are in the following order: *Root certificates* > *Intermediate certificates* > *End-user certificates*. Root certificate authorities (CAs) are a trusted source of certificates. Intermediate CA certificates are bridges that link the end-user certificates to the root CA certificates. To create and set up a chain of certificates, follow these steps.

    - On the Action Pane, select **Chain of certificates**.
    - Select **New** to create a chain of certificates.
    - In the **Name** field, enter the name of the chain of certificates.
    - In the **Description** field, enter a description.
    - In the **Certificates** section, select **Add** to add a certificate to the chain.
    - Use the **Up** or **Down** button to change the position of the certificate in the chain. Keep the CA root certificate at the top of the list and the end-user certificate at the bottom.
    - Save the data and close the **Chain of certificates** page.

11. Save the data and close the **Key Vault parameters** page.
12. In **Key Vault** field, select the Key Vault created during the previous steps.
13. In the **Storage SAS token secret** field, select the name of the storage account secret that must be used to authenticate access to the storage account.

### Configure Number sequences

If your scenarios require number sequences (for example, in file names), you can use number sequences that can be used either across Globalization features or for a specific Globalization feature. After a number sequence is defined, you can use it in variables and processing pipelines. To track its use, look for a value of **Current Value** field and the **In use** parameter for a selected number sequence.

Select **New** to create a number sequence. Then enter a name and description. 
Select **Delete** to delete a number sequence if it's no longer used.

