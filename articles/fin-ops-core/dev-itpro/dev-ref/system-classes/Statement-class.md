---
title: Statement class
description: This topic describes the Statement class.
author: robinarh
manager: tonyafehr
ms.date: 06/25/2020
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 

audience: Developer
ms.reviewer: rhaertle
ms.search.scope: Operations
ms.search.region: Global
ms.author: rhaertle
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
---

# Class Statement

[!include [banner](../../includes/banner.md)]

```xpp
class Statement extends Object
```

The Statement class executes a static SQL statement and obtains the results it produces.

## Remarks

Only one per Statement can be open at any point in time. Therefore, if the reading of one ResultSet is interleaved with the reading of another, each must have been generated by different Statements. Record and field level securities are not enforced on the Statement class. Therefore, make sure you are not exposing data returned to the user without doing explicit security validation. All statement executed methods implicitly close a statement's current ResultSet if an open one exists.

## Examples

```xpp
static void example() 
{ 
    Connection Con; 
    Statement Stmt; 
    ResultSet R; 
    SqlStatementExecutePermission perm; 
    str sql = 'SELECT VALUE FROM SQLSYSTEMVARIABLES'; 
    Con = new Connection(); 
    Stmt = Con.createStatement(); 
    perm = new SqlStatementExecutePermission(sql); 
    perm.assert(); 
    R = Stmt.executeQuery(sql); 
    while ( R.next() ) 
    { 
        print R.getString(1); 
    } 
}
```

## Methods

| Method                                       | Description                                                                                       |
|----------------------------------------------|---------------------------------------------------------------------------------------------------|
| public ResultSet executeQuery(str statement) | Executes an SQL statement that returns an instance of the .                                       |
| public int executeUpdate(str statement)      | Executes a SQL INSERT, UPDATE, or DELETE statement.                                               |
| public int getLastError()                    | Retrieves the error code returned by the SQL database backend for the last SQL operation.         |
| public str getLastErrorText()                | Retrieves the error text that is returned by the SQL database backend for the last SQL operation. |
| public int getMaxFieldSize()                 | Returns the current maximum column size limit, if any.                                            |
| public void close()                          | Releases the database resources of a statement object.                                            |
| public void setMaxFieldSize(int max)         | Sets the maximum column size limit.                                                               |

## Method executeQuery

Executes an SQL statement that returns an instance of the .

```xpp
public ResultSet executeQuery(str statement)
```

### Parameters - executeQuery

statement  
The string that contains the SQL statement that is used to retrieve the result set.

### Return Value - executeQuery

The object that contains the data returned from the query.

### Remarks - executeQuery

If users control input to the executeQuery method, an SQL injection threat can occur. Therefore, this method runs under Code Access Security. Calls to this method on the server require permission from the . The following are safer alternatives for executing SQL statements:

-   Queries
-   Views
-   X++ select statements

Record level security is not enforced on the Statement class. If data is exposed to the user, perform explicit security validation.

### Examples - executeQuery

The following example performs an SQL query on CustTable, which runs on the server. The result of the query is stored in the resultSet object.

```xpp
server static void main(Args _args) 
{ 
    DictTable  dictTable; 
    Connection connection; 
    Statement  statement; 
    str        sql; 
    ResultSet  resultSet; 
    SqlStatementExecutePermission perm; 
    dictTable = new DictTable(tableNum(CustTable)); 
    if (dictTable != null) 
        { 
           connection = new Connection(); 
           sql = strfmt( "SELECT * FROM %1", dictTable.name(DbBackend::Sql) ); 
           perm = new SqlStatementExecutePermission(sql); 
           // Check for permission to use the statement. 
           perm.assert(); 
           statement = connection.createStatement(); 
           resultSet = statement.executeQuery(sql); 
           // End the scope of the assert call. 
           CodeAccessPermission::revertAssert(); 
        } 
}
```

## Method executeUpdate

Executes a SQL INSERT, UPDATE, or DELETE statement.

```xpp
public int executeUpdate(str statement)
```

### Parameters - executeUpdate

statement  
The string that contains the SQL statement being passed to the database.

### Return Value - executeUpdate

An updated row count; otherwise, 0 (zero) for SQL statements that return nothing.

### Remarks - executeUpdate

SQL statements that return nothing, such as SQLDDL statements, can also be executed. If users control input to the executeUpdate method, an SQL injection thread can occur. Therefore, this method runs under Code Access Security. Calls to this method on the server require permission from the . The following are safer alternatives for interacting with the database:

-   Queries
-   Views
-   X++ select statements

Record level security is not enforced on the Statement class. If data is exposed to the user, perform explicit security validation.

## Method getLastError

Retrieves the error code returned by the SQL database backend for the last SQL operation.

```xpp
public int getLastError()
```

### Return Value - getLastError

The error code returned by the SQL database backend for the last SQL operation; or 0 for success.

### Examples - getLastError

```xpp
static void StatementGetLastError()  
{ 
    str sql, sql2; 
    UserConnection Connection = new UserConnection(); 
    Statement Statement = Connection.createStatement(); 
    boolean clear_infolog = false; 
    print "-Delete-a-non-existing-record-(valid statement)-----------"; 
    sql = "delete from zipcode where Recid = 2"; 
    new SqlStatementExecutePermission(sql).assert(); 
    Statement.executeUpdate(sql); 
    print " Error code was: ", Statement.getLastError(); 
    print " Error message was '", Statement.getLastErrorText(), "'"; 
    try 
    { 
        print "\n"; 
        print "-Delete-from-a-non-existing-table-(invalid statement)---    --"; 
        sql2 = "delete from StrangeTable07"; 
        new SqlStatementExecutePermission(sql2).assert(); 
        Statement.executeUpdate(sql2); 
    } 
    catch (exception::Error) 
    { 
        print "Exception was caught:"; 
        print " Error code was: ", Statement.getLastError(); 
        print " Error message was '", Statement.getLastErrorText(), "'"; 
    } 
    CodeAccessPermission::revertAssert(); 
    pause; 
}
```

## Method getLastErrorText

Retrieves the error text that is returned by the SQL database backend for the last SQL operation.

```xpp
public str getLastErrorText()
```

### Return Value - getLastErrorText

The error text that is provided by the SQL database for the last SQL operation.

## Method getMaxFieldSize

Returns the current maximum column size limit, if any.

```xpp
public int getMaxFieldSize()
```

### Return Value - getMaxFieldSize

The current maximum column size limit; 0 means unlimited.

### Remarks - getMaxFieldSize

The maxFieldSize limit (in bytes) is the maximum amount of data returned for any column value; it only applies to binary, varbinary, longvarbinary, char, varchar, and longvarchar columns. If the limit is exceeded, the excess data is silently discarded.

## Method close

Releases the database resources of a statement object.

```xpp
public void close()
```

## Method setMaxFieldSize

Sets the maximum column size limit.

```xpp
public void setMaxFieldSize(int max)
```

### Parameters - setMaxFieldSize

max  
The new max column size limit; 0 means unlimited.

### Remarks - setMaxFieldSize

The maxFieldSize limit (in bytes) is set to limit the size of data that can be returned for any column value; it only applies to binary, varbinary, longvarbinary, char, varchar, and longvarchar fields. If the limit is exceeded, the excess data is silently discarded. For maximum portability, use values greater than 256.

